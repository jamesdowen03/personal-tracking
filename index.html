<!DOCTYPE html>
<html>
<head>
  <title>My Personal App</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: sans-serif; padding: 20px; text-align: center; }
    input, button {
      padding: 10px;
      font-size: 18px;
      margin-top: 10px;
    }
  </style>
</head>

<body>

  <h1 id="greeting">Welcome!</h1>

  <div id="nameForm">
    <p>Enter your name:</p>
    <input id="nameInput" type="text" placeholder="Your name" />
    <button onclick="saveName()">Save</button>
  </div>

  <!-- Event List View -->
  <div id="eventListView" style="display:none;">
    <h2>Your Events:</h2>
    <ul id="eventList"></ul>
    <button onclick="showEventForm()">Add Event</button>
  </div>

  <!-- Event Form View -->
  <div id="eventFormView" style="display:none;">
    <h2>Add an Event:</h2>

    <!-- Event Name -->
    <p>Event Name:</p>
    <input id="eventNameInput" type="text" placeholder="Event name" />

    <!-- Color -->
    <p>Event Color:</p>
    <input id="eventColorInput" type="color" />

    <!-- Time -->
    <p>Time:</p>
    <input id="eventTimeInput" type="time" />

    <!-- Day -->
    <p>Day of Week:</p>
    <select id="eventDayInput">
      <option>Monday</option>
      <option>Tuesday</option>
      <option>Wednesday</option>
      <option>Thursday</option>
      <option>Friday</option>
      <option>Saturday</option>
      <option>Sunday</option>
    </select>

    <!-- Repetition -->
    <p>Repetition:</p>
    <select id="eventRepeatInput">
      <option>None</option>
      <option>Daily</option>
      <option>Weekly</option>
      <option>Monthly</option>
    </select>

    <p>Remind every X days:</p>
    <input id="eventEveryXDays" type="number" min="1" placeholder="ex: 3" />

    <!-- Rotation (sub-events) -->
    <p>Rotation / Sub-events (comma separated):</p>
    <input id="eventRotationInput" type="text" placeholder="ex: wash, dry, fold" />

    <br/><br/>
    <button onclick="addEvent()">Save Event</button>
    <br/><br/>
    <button onclick="showEventList()">Back to Event List</button>
  </div>

  <script>
    const savedName = localStorage.getItem("username");

    // If name exists → show greeting + events
    if (savedName) {
      document.getElementById("greeting").innerText = "Welcome back, " + savedName + "!";
      document.getElementById("nameForm").style.display = "none";
      document.getElementById("eventListView").style.display = "block";
    }

    function saveName() {
      const input = document.getElementById("nameInput").value;
      if (input) {
        localStorage.setItem("username", input);
        location.reload();
      }
    }

    function showEventForm() {
      document.getElementById("eventListView").style.display = "none";
      document.getElementById("eventFormView").style.display = "block";
    }

    function showEventList() {
      document.getElementById("eventFormView").style.display = "none";
      document.getElementById("eventListView").style.display = "block";
    }

    function addEvent() {
      const name = document.getElementById("eventNameInput").value;
      const color = document.getElementById("eventColorInput").value;
      const time = document.getElementById("eventTimeInput").value;
      const day = document.getElementById("eventDayInput").value;
      const repeat = document.getElementById("eventRepeatInput").value;
      const rotationText = document.getElementById("eventRotationInput").value;
      const rotation = rotationText ? rotationText.split(",") : [];
      const everyXDays = document.getElementById("eventEveryXDays").value;

      if (!name) {
        alert("You must enter an event name.");
        return;
      }

      let events = JSON.parse(localStorage.getItem("events") || "[]");
      events.push({
        name: name,
        color: color,
        time: time,
        day: day,
        repeat: repeat,
        rotation: rotation,
        everyXDays: everyXDays ? Number(everyXDays) : null
      });
      localStorage.setItem("events", JSON.stringify(events));

      // Clear inputs
      document.getElementById("eventNameInput").value = "";
      document.getElementById("eventRotationInput").value = "";

      loadEvents();
      showEventList();
    }

    function loadEvents() {
      let events = JSON.parse(localStorage.getItem("events") || "[]");
      const list = document.getElementById("eventList");
      list.innerHTML = "";

      events.forEach(event => {
        const li = document.createElement("li");
        li.innerHTML = `<span style='color:${event.color}'>●</span> ${event.name} (${event.day} @ ${event.time}, ${event.repeat})`;
        list.appendChild(li);
      });
    }

    if (savedName) loadEvents();
  </script>
</body>


</html>
